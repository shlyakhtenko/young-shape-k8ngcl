"use strict";(self.webpackChunkreact=self.webpackChunkreact||[]).push([[987],{2987:(e,a,t)=>{t.r(a),t.d(a,{default:()=>u});var n=t(2791),s=t(2943),i=t(3360),l=t(6638),d=t(8282),r=t(3494),o=t.n(r),c=t(184);function h(e){const[a,t]=(0,n.useState)(!1),l="https://docs.ipam.ucla.edu"+e.url+"&ipam_id="+e.ipam_id+"&session_token="+e.session_token,d=new Date(e.date);return(0,c.jsxs)(c.Fragment,{children:[a?(0,c.jsx)("div",{className:"modal show attachmentModal",children:(0,c.jsxs)(s.Z,{show:a,size:"xl",onHide:()=>t(!1),centered:!0,children:[(0,c.jsx)(s.Z.Header,{closeButton:!0,children:(0,c.jsx)(s.Z.Title,{className:"attachmentModalTitle",children:"Attachment Display"})}),(0,c.jsx)(s.Z.Body,{children:(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{children:["Name: ",e.name]}),(0,c.jsxs)("div",{children:["Date: ",e.date]}),(0,c.jsx)("div",{className:"attachmentViewer",children:(0,c.jsx)(o(),{zoom:203,fileType:e.type.split("/")[1],filePath:l,onError:()=>t(!1)})})]})}),(0,c.jsx)(s.Z.Footer,{children:(0,c.jsx)(i.Z,{variant:"secondary",onClick:()=>t(!1),children:"Close"})})]})}):null,(0,c.jsxs)("div",{className:"attachment",onDoubleClick:()=>t(!0),children:[(0,c.jsx)("img",{src:e.icon_url}),(0,c.jsx)("div",{className:"attachmentName",children:e.name}),(0,c.jsx)("div",{className:"attachmentDate",children:1+d.getMonth()+"/"+d.getDate()+"/"+d.getFullYear()+" "+d.getHours()%12+":"+d.getMinutes()+(d.getHours()>=12?"PM":"AM")})]})]})}var p=t(1424);function u(e){const[a,t]=(0,n.useState)(!1),[s,i]=(0,n.useState)(!1);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(d.Z,{className:"Card"+(e.wilted?" wilted":"")+(e.brand_new?" brand_new":"")+(e.criteria_satisfied?"":" criteria_not_satisfied "),children:(0,c.jsxs)(d.Z.Body,{onDoubleClick:()=>i(!0),children:[(0,c.jsx)(d.Z.Title,{children:Object.entries(e.data).map((e=>{let[a,t]=e;return t.display_on_card?(0,c.jsxs)("div",{className:(t.editable?"Editable":"notEditable")+" "+a.toString()+" "+t.edit_type,children:[(0,c.jsxs)("span",{className:"caption",children:[t.caption,":"]})," ",(0,c.jsx)("span",{className:"value "+t.edit_type,children:"select_yesno"!=t.edit_type?t.value:null==t.value?"":1==t.value?"Yes":"No"})]},a):null}))}),(0,c.jsx)(d.Z.Body,{children:Object.entries(e.data).map((e=>{let[a,t]=e;return!t.display_on_card&&t.edit?(0,c.jsxs)("div",{className:(t.editable?"Editable":"notEditable")+" "+a.toString()+" "+t.edit_type,children:[(0,c.jsxs)("span",{className:"caption",children:[t.caption,":"]})," ",(0,c.jsx)("span",{className:"value "+t.edit_type,children:"select_yesno"!=t.edit_type?t.value:null==t.value?"":1==t.value?"Yes":"No"})]},a):null}))})]})}),(0,c.jsx)(m,{show:a,setter:t}),s?(0,c.jsx)(j,{show:s,setter:i,data:e.data,card_id:e.card_id,loginToken:e.loginToken,pipeline_name:e.pipeline_name,program_code:e.program_code,update_card_data_function:e.update_card_data_function}):null]})}function m(e){return(0,c.jsx)("div",{children:(0,c.jsxs)(s.Z,{show:e.show,onHide:()=>e.setter(!1),children:["CardEditor",(0,c.jsx)(s.Z.Header,{closeButton:!0})]})})}function j(e){var[a,t]=(0,n.useState)(e.data),[d,r]=(0,n.useState)(!1),[o,u]=(0,n.useState)([]),[m,j]=(0,n.useState)(!1);return d||(r(!0),function(e,a,t,n,s,i){const l="https://docs.ipam.ucla.edu/cocytus/get_associated_files.php?ipam_id="+e.ipam_id+"&session_token="+e.session_token+"&pipeline="+n+"&programcode="+s+"&card_id="+t;fetch(l,{mode:"cors",method:"GET",headers:{}}).then((e=>{console.log("get_attachments: url",l),e.json().then((e=>{console.log("get_attachments: Got data...",e),a(e)})).catch((e=>{i((0,c.jsxs)("div",{children:[(0,c.jsx)("h1",{children:"JSON conversion error"}),(0,c.jsx)("h2",{children:""+e}),(0,c.jsxs)("div",{children:["url: "+l," "]}),(0,c.jsx)("div",{children:"Check your login credentials and whether the pipline name is valid"})]}))}))})).catch((e=>{i((0,c.jsxs)("div",{children:[(0,c.jsx)("h1",{children:"Data load error"}),(0,c.jsx)("h2",{children:""+e}),(0,c.jsxs)("div",{children:["url: "+l," "]}),(0,c.jsx)("div",{children:"Check your login credentials and whether the pipline name is valid"})]}))}))}(e.loginToken,u,e.card_id,e.pipeline_name,e.program_code,console.log)),(0,c.jsx)("div",{className:"modal show cardModal",children:(0,c.jsxs)(s.Z,{show:e.show,size:"lg",onHide:()=>{e.setter(!1),t(e.data)},children:[(0,c.jsx)(s.Z.Header,{closeButton:!0,children:(0,c.jsx)(s.Z.Title,{className:"cardModalTitle",children:Object.entries(e.data).map((e=>{let[a,t]=e;return t.display_on_card&&!t.edit?(0,c.jsx)("div",{children:(0,c.jsx)("span",{className:"value",children:t.value})},a):(0,c.jsx)("div",{},a)}))})}),(0,c.jsxs)(s.Z.Body,{children:[(0,c.jsx)(l.Z,{children:Object.entries(a).map((e=>{let[n,s]=e;return s.edit?(0,c.jsx)("div",{children:(0,c.jsxs)(l.Z.Group,{className:"mb-3",children:[(0,c.jsx)(p.Z,{children:s.caption}),"select_yesno"==s.edit_type?(0,c.jsxs)(l.Z.Select,{value:s.value,onChange:e=>{t({...a,[n]:{...a[n],value:e.target.value}})},children:[(0,c.jsx)("option",{value:null,children:"Unknown"}),(0,c.jsx)("option",{value:1,children:"Yes"}),(0,c.jsx)("option",{value:0,children:"No"})]}):(0,c.jsx)(l.Z.Control,{as:"textarea"==s.edit_type?"textarea":"input",rows:4,id:n,value:s.value?s.value:"",onChange:e=>{t({...a,[n]:{...a[n],value:e.target.value}})}})]})},n):(0,c.jsx)("div",{},n)}))}),(0,c.jsx)(p.Z,{children:"Attachments"}),(0,c.jsx)("div",{className:"attachments"+(m?" dragOver":""),onDragOver:e=>{e.stopPropagation(),e.preventDefault(),j(!0)},onDragLeave:e=>{e.stopPropagation(),e.preventDefault(),j(!1)},onDrop:a=>{a.stopPropagation(),a.preventDefault();let t=null;console.log(a),Object.entries(a.dataTransfer.items).forEach((a=>{let[n,s]=a;if("file"==s.kind){t=new FormData,t.append("attachment",s.getAsFile()),t.append("card_id",e.card_id),t.append("pipeline",e.pipeline_name),t.append("program_code",e.program_code),t.append("userid",e.data.userid.value);const a={};console.log("headers",a,"formdata:",t);const n="https://docs.ipam.ucla.edu/cocytus/upload_attachment.php?ipam_id="+e.loginToken.ipam_id+"&session_token="+e.loginToken.session_token;fetch(n,{body:t,mode:"cors",method:"POST",headers:a}).then((e=>{e.text().then((e=>console.log("uploaded file and got",e))),j(!1),r(!1)}))}}))},children:o.map((a=>(0,c.jsx)(h,{name:a.name,icon_url:a.icon_url,id:a.id,url:a.url,type:a.type,date:a.date,ipam_id:e.loginToken.ipam_id,session_token:e.loginToken.session_token},a.id)))})," "]}),(0,c.jsxs)(s.Z.Footer,{children:[(0,c.jsx)(i.Z,{variant:"primary",onClick:()=>{e.setter(!1),console.log(a),e.update_card_data_function(a)},children:"Save"}),(0,c.jsx)(i.Z,{variant:"secondary",onClick:()=>{e.setter(!1),t(e.data)},children:"Cancel"})]})]})})}}}]);
//# sourceMappingURL=987.29b41897.chunk.js.map